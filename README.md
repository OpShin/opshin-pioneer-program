<div align="center">
  <a href="https://github.com/OpShin/opshin-pioneer-program">
    <img src="https://github.com/OpShin/opshin-pioneer-program/blob/main/opshin-pioneer-program.png" width="200" />
  </a>
  <h1> Opshin Pioneer Program </h1>
  <a href="https://github.com/input-output-hk/plutus-pioneer-program">
    <img src="https://img.shields.io/badge/cohort-4-red?logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QAlQBsAFoq1pmxAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5wQDCScJjGi5+gAABGdJREFUWMPtl9lvVWUUxX+rvYVWpjJflJZRBJFBJZRZNJBoog8mGgn4QEzUP8uYGI3GIT44JBKjGBUxFgOlQLUMQlHKIGmLBQtdPrAuOVy4Bcfw4Hm5557vfHtYe6397QP/X7ls67/2NaJP23X/RFC2Zbuu1rpsbwN+B3YCfcCQpMvVwUga/pOOb9hjuwFoAKYAq4CGEjABuAtYDxhotD2YYLolHakYsi1JvlXGklzYswCYBYyNn35gItAITFZeOC+pt2BkHNACLACagU5Ju2+FRnHN9hpgHnAa6AaOS7pYeHcOcLlChhZgM3AK2ANcAPoLxjYBc4APJfXUgFeSbHt+0NxfCLoEjAPGAG3AeOBtSf2l7J8V+OcCFwNRvW0DxyTtsD0a2G77e0nfVGVbcb4BKEt6xXa97Y3ANKAOuAQMAHfnvgXoLGaw2PYo22OLpbDdZvvFQIrtbbZXVyvF9mNBCtuP237B9lLbTQV7jbbHp+xXVVCVQRuwHBgCdgPngZ6srQYWAq8BzwM7JXVn/xLgHuBrYEvWDgS1chBdGQV8IqmrgmDpJly6HKjqgAeBdbaHgS+AI8BzuX8E6LbdCMwHOoCngNeBsu2twJWo6QTwW1RQ6Qm+hkAVmZqBEjC3QKLJyWA00APMBEaFsEQtoxLgvRUyS+rL/lXAAcCVZ9eV4CZBbM/aRODzIHIh2r0/vaMM7AtiDwBngLMh1nAY3xx1HQMGJL1braBSjX6yN/V+K5kDnIx8LgWJ9QlwTJj9XiBfkGYzF+gF3gDWxuY16EcMQFI70G77oTiYEHkORVZTgRXpbk35LSfzU5HY+ATaIenVgu3rAqirUYJJtlcAP4Y8HcChvH8u3e14+PAL8HMc96V03wE/5fmA7TVFOdbkQEGO2xJ9UxyNidOTQGuyXR7Z1QNLUvueBNKa+venlOeAs5LeH5EDBXh+iLR2SepMcNNygl2I4U5gf4ET/bHXCnxZUEBvzoSD8TE8EgLlkKs9BCKsn1c4spfnvgy8k/qvjK1+4CiwMXw5lDLWAbOT1A5J/dWdsE7SsO0nw+zZybAeOBwiXbS9BegCJkVWu7J/baQ6FRgt6YP0k8Uh5JU4P52T9Svb9ZKuVJOvyfYTtidUPW+z/bLt6bYftv1M9Uhl+2nbLbYX2n7J9uIqGy22N9muv6EEtluBDSHcnsA6I1puBA5K+tb2o8A0SW/WUM+zwAFJHXm3Jco4nJIOpic0Ax9LOlcJYEPO+3LqVtFzl6RfbU9Jnz8i6bNaU1DuN+fs/0jSYMh7X8rWkPL2haj7ixAuTfRDhWcLgWX5+6mk07c5ls0E1kUx+yQdLaxNBKZK6qoMpVvD6vZEPgOYHOKcAfZWxrXbGU6rBpWZwKJkT86KnrTjZUB9KS2zlIZxJizvlTRQa9Ac6YqalPsTwIn8H5cSN2cCawKmK2ztk3T8dkbrv/BdcFMbthcBg0UO1Aca36rGf/OLSFfBudoDVIDrX3F6J3wK3tnXHzzemiq9XlPlAAAAAElFTkSuQmCC">
  </a>
  <a href="https://www.python.org/downloads/">
    <img src="https://img.shields.io/badge/language-python3-3670A0?logo=python&logoColor=959da5">
  </a>
  <a href="https://github.com/OpShin/opshin-pioneer-program/actions/workflows/test.yaml">
    <img src="https://github.com/OpShin/opshin-pioneer-program/actions/workflows/test.yaml/badge.svg"/>
  </a>
  <a href="https://github.com/OpShin/opshin-pioneer-program/actions/workflows/test-solutions.yaml">
    <img src="https://github.com/OpShin/opshin-pioneer-program/actions/workflows/test-solutions.yaml/badge.svg"/>
  </a>
  <a href="https://discord.com/invite/umR3A2g4uw">
    <img src="https://dcbadge.vercel.app/api/server/umR3A2g4uw?style=flat&theme=default-inverted&compact=true"/>
  </a>
</div>


This repository implements many educational Cardano Smart Contracts in Python using [opshin](https://github.com/OpShin/opshin).
It also comes with off-chain code using [PyCardano](https://github.com/Python-Cardano/pycardano) and a host of test cases to ensure high quality of the resulting contracts.
Most of the code is in a similar format to the [plutus-pioneer-program](https://github.com/input-output-hk/plutus-pioneer-program).
Join the opshin [discord server](https://discord.com/invite/umR3A2g4uw) for Q/A and interact with other opshin pioneers!

## Installation

1. Install Python 3.9, 3.10 or 3.11 (if it not already installed on your operating system).
Python3.11 Installer [download](https://www.python.org/downloads/release/python-3112/).

2. Install python poetry.
Follow the official documentation [here](https://python-poetry.org/docs/#installation).

3. Install a python virtual environment with poetry:
```bash
# clone the repository including the config submodule necessary for running the node
git clone --recurse-submodules -j8 https://github.com/OpShin/opshin-pioneer-program.git
cd opshin-pioneer-program

# Optional. Use a specific python version
# replace <version> with 3.8, 3.9, 3.10, or 3.11
# for this to work, python<version> must be accessible in your command line
# alternatively provide the path to your python executable
poetry env use <version>

# install python dependencies
poetry install

# run a shell with the virtual environment activated
poetry shell

# If you're not in a shell, you can run python scripts with `poetry run`
poetry run python <script-path>
```

### Cardano Node

First install Docker.
Follow the official documentation [here](https://docs.docker.com/get-docker/).


To start a [Cardano Node](https://github.com/input-output-hk/cardano-node) and [Ogmios API](https://ogmios.dev/) use [docker-compose](https://docs.docker.com/get-started/08_using_compose/) in your terminal:

```bash
# starts a cardano node and ogmios api on the preview testnet
docker compose up
```

You can then access the `cardano-cli` using the docker image:
```bash
docker run --rm -it \
  --entrypoint cardano-cli \
  -e CARDANO_NODE_SOCKET_PATH=/ipc/node.socket \
  -v opshin-pioneer-program_node-db:/data \
  -v opshin-pioneer-program_node-ipc:/ipc \
  inputoutput/cardano-node
```

## How to Follow the Pioneer Lectures and Code
Here's a rough mapping of the lecture videos and what parts of this repository you can work on for each week.
Some files may not be documented thoroughly so try to infer the purpose by referring the structure of the lectures.

### [Lecture 1](https://www.youtube.com/playlist?list=PLNEK_Ejlx3x3xFHJJKdyfo9eB0Iw-OQDd)

- [Welcome and Introduction](https://youtu.be/g4fBo4QPir0)
- [Setting up Our Development Environment](https://youtu.be/-cmIqKCzzOU)
- [Kuber Marketplace Demo](https://youtu.be/ZaB-7ZYBi3g)
- [Hashing & Digital Signatures](https://youtu.be/f-WKPWbk9Jg)
- [The EUTxO-Model](https://youtu.be/ulYDNaEKf4g)
- [Homework](https://youtu.be/Ey903I-R1KY)
  - Follow the above installation instructions and get this repository set up locally.
  - Test your node synchronization with `scripts/query_tip.sh`

### [Lecture 2](https://www.youtube.com/playlist?list=PLNEK_Ejlx3x1-oF7NDy0MhXxG7k5O6ZOA)

- [Low-Level, Untyped Validation Scripts](https://youtu.be/3tcWCZV6L_w)
  - Study and compare the gift contract in opshin to plutus.
  - `src/week02/lecture/gift.py`
- [Using the Cardano CLI to Interact with Plutus](https://youtu.be/2MbzKzoBiak)
  - We use PyCardano to create off-chain scripts for our opshin contracts.
    Run the following python scripts with `poetry run python <script-path>`.
    The bash scripts using the dockerized Cardano CLI are also provided for reference.
  - Create your test wallets with `poetry run python scripts/create_key_pair.py --help`
    - The wallets are generated in the `keys/` directory.
    - Fund your wallets with the address in `keys/<name>.addr` at the [Cardano Testnet Faucet](https://docs.cardano.org/cardano-testnet/tools/faucet)
    - Use the name of your key as arguments for the offchain scripts below.
  - Look here for offchain code: `src/week02/scripts/`. PyCardano examples:
    - Build the lecture scripts `poetry run python -m src/week02/scripts/build.py`.
      The output is saved in the `src/week02/assets` folder.
    - Send ada `poetry run python src/week02/scripts/send.py`
    - Make gift `poetry run python src/week02/scripts/make_gift.py`
    - Collect gift `poetry run python src/week02/scripts/collect_gift.py`
    - You can reference `make_gift.sh` and `collect_gift.sh` for the equivalent using the Cardano CLI,
      but going forward we will use pycardano to get a consistent and holistic Python experience.
  - Look here for helper scripts (such as creating a test wallet): `scripts/`
- [High-Level, Typed Validation Scripts](https://youtu.be/GT8OjOzsOb4)
  - Review the rest of the opshin scripts.
  - `src/week02/lecture/fourty_two.py`
  - `src/week02/lecture/fourty_two_typed.py`
  - `src/week02/lecture/custom_types.py`
  - `src/week02/lecture/burn.py`
  - You can choose which lecture script to use in `make_gift.py` and `collect_gift.py` with the argument `--script <script-name>`
- [Summary](https://youtu.be/F5ewN65Mn4I)
- [Homework](https://youtu.be/OR2IfD4oDjw)
  - Complete the following homework files:
  - `src/week02/homework/homework1.py`
  - `src/week02/homework/homework2.py`
  - You can test your solution with:
  - `pytest src/week02/tests/test_homework.py`
  - The solutions are available at on the [`solutions`](https://github.com/OpShin/opshin-pioneer-program/tree/solutions) branch

### [Lecture 3](https://www.youtube.com/playlist?list=PLNEK_Ejlx3x2zXSjHRKLSc5Jn9vJFA3_O)

- [Script Contexts](https://youtu.be/dcoYrIyEI4o)
- [Handling Time](https://youtu.be/LPzwMqOnWvk)
- [A Vesting Example](https://youtu.be/5D0O7q9UPJA)
  - `src/week03/lecture/vesting.py`
- [Parameterized Contracts](https://youtu.be/ZSKVu32c5eA)
  - `src/week03/lecture/parameterized_vesting.py`
- [Offchain Code with Lucid](https://youtu.be/C8TuGSzhqXU)
  - We implement the same in pycardano instead in `src/week03/scripts`.
- [Reference Scripts](https://youtu.be/Rnyc5YXVXew)
  - To be implemented...
- [Homework](https://youtu.be/hdt4XqFeEyg)
  - Complete the following homework files:
  - `src/week03/homework/homework1.py`
  - `src/week03/homework/homework2.py`
  - Like before, you can run tests with `pytest src/week03/tests`
- [Summary](https://youtu.be/gxan_u2pStE)

### [Lecture 4](https://www.youtube.com/playlist?list=PLNEK_Ejlx3x2j587Ox_nwEzmCO-elk8BG)
This lecture is about alternative offchain solutions.
We use pycardano, but you can compare and contrast alternatives.

- [On-chain VS Off-chain](https://youtu.be/pTc_BJby5GU)
- [Off-chain Code with Cardano CLI and GUI](https://youtu.be/gsgQ-xmzbpA)
- [Off-chain Code with Kuber](https://youtu.be/fzib9ALlL2M)
- [Off-chain Code with Lucid](https://youtu.be/BXz5V2rjbiE)
- [Homework](https://youtu.be/2Qm2xgmtbk4)
  - Implement the offchain code for the files in `src/week04/homework`.
  - Although the contracts are implemented in opshin, you can use offchain code other than pycardano to complete this.
  - There is no correct solution for this week as solutions can very widely.
    So make sure to test your code!
  - Feel free to submit your solution by making a PR to the `solutions` branch!
  - We will continue to implement off-chain code in pycardano for this repository.

### [Lecture 5](https://www.youtube.com/playlist?list=PLNEK_Ejlx3x2T1lIR4XnDILKukj3rPapi)

- [Introduction](https://youtu.be/HgXYsMFqnb4)
- [Values](https://youtu.be/ThYByMLC0EI)
- [A Simple Minting Policy](https://youtu.be/g_VoKPK-tk0)
  - `src/week05/lecture/free.py`
  - Off-chain minting script: `python src\week05\scripts\mint.py --script=free WALLET_NAME TOKEN_NAME`
- [A More Realistic Minting Policy](https://youtu.be/Faru8_Br2Xg)
  - `src/week05/lecture/signed.py`
  - Off-chain minting script: `python src\week05\scripts\mint.py --script=signed WALLET_NAME TOKEN_NAME`
- [NFT's](https://youtu.be/9kW-z_RuwEY)
  - `src/week05/lecture/nft.py`
  - Off-chain minting script: `python src\week05\scripts\mint.py --script=nft WALLET_NAME TOKEN_NAME`
- [Homework](https://youtu.be/nQC_GNPIRT8)
  - Complete the minting policies in `src/week05/homework`.
  - Test your solution with `pytest src/week05/tests`

### [Lecture 6](https://www.youtube.com/playlist?list=PLNEK_Ejlx3x08fHgl_ZTlowVO8bjqITEh)

- [The State Monad in practice](https://www.youtube.com/watch?v=8tWzG0ML6Z4&list=PLNEK_Ejlx3x08fHgl_ZTlowVO8bjqITEh&index=1)
  - You can skip this for opshin.
- [Introduction to the Plutus Simple Model library](https://youtu.be/Sft02LeXA_U)
  - We implement `MockChainContext` and `MockUser` in `src/utils/mock.py`.
    These classes allow us to easily test and evaluate our opshin contracts without the Cardano Node!
  - Make sure you have the latest dependencies installed and pyaiken which we use to evaluate transactions without the node.
    - `poetry install --sync --extras=pyaiken`
  - We implement a simple test in `src/week06/tests/test_mock.py` with simulated spending and multiple users.
- [Unit Testing a Smart Contract](https://youtu.be/vB8hyVq3HVo)
  - Unit tests located in `src/week06/tests/test_negative_r_timed.py`
- [Property Testing a Smart Contract](https://youtu.be/pF8HpKmaQi4)
  - Property tests also located in `src/week06/tests/test_negative_r_timed.py`
  - Read the documentation on [hypothesis](https://hypothesis.readthedocs.io/en/latest/)
    to get familiar with property testing in Python.
- [Testing Smart Contracts with Lucid](https://youtu.be/aUrIuDQgg5c)
  - N/A.
- [Double Spending and Homework](https://youtu.be/AZVpkwRhEaY)
  - Complete the following test `src/week06/homework/test_exploitable_swap.py`
  - Use your completed test to implement a fix to the swap script: `src/week06/homework/fixed_swap.py`


### [Lecture 7](https://www.youtube.com/playlist?list=PLNEK_Ejlx3x0wH_y1lQp4xtrkuaYSWi6V)
This week introduces Marlowe. There won't be any relevant opshin code for this week.

- [Introduction](https://youtu.be/KCWuj2DXEY4)
- [Marlowe Playground Demo](https://youtu.be/fldaBHmYfqk)
- [Homework](https://youtu.be/C4WWnQZOAAM)
- [Marlowe Starter Kit: Docker](https://youtu.be/wgSvPlWUrf8)
- [Marlowe Starter Kit: Preliminaries](https://youtu.be/hGBmj9ZrYHs)
- [Marlowe Starter Kit: ZCB using the Marlowe Runtime command-line client](https://youtu.be/pjDtuD5rimI)
- [Marlowe Starter Kit: ZCB using the Marlowe Runtime REST API](https://youtu.be/wgJVdkM2pBY)
- [Marlowe Starter Kit: ZCB using the Marlowe Runtime CLI](https://youtu.be/ELc72BKf7ec)
- [Marlowe Starter Kit: Escrow using the Marlowe Runtime's REST API](https://youtu.be/E8m-PKbS9TI)
- [Marlowe Starter Kit: Swap contract using the Marlowe Runtime's REST API](https://youtu.be/sSrVCRNoytU)

### [Lecture 8](https://www.youtube.com/playlist?list=PLNEK_Ejlx3x09VdtQTw_UpxUa0bRcrVPI)

- [Introduction](https://youtu.be/07ATzubeHjo)
- [The Private Testnet](https://youtu.be/BBqOZAuMx1c)
- [Plutus & Staking](https://youtu.be/1Hs6bU9pXi4)
- [Trying it on the Testnet](https://youtu.be/fzYXwdrfu44)
- [Homework](https://youtu.be/rO3FVGsuzUg)

### [Lecture 9](https://www.youtube.com/playlist?list=PLNEK_Ejlx3x3ZWTpR5lhoVs_DHkebiBcU)

- [Creating our own Stablecoin Dapp](https://youtu.be/KDzyMy0WN9M)
- [Using our Stablecoin UI](https://youtu.be/MVq51lZkutA)
- [Stablecoin's Oracle](https://youtu.be/XfbEsFPbzCI)
- [Deploying Stablecoin's Reference scripts](https://youtu.be/AokRj-upwlY)
- [Minting Stablecoins](https://youtu.be/mUa9sztfPKs)
- [Burning Stablecoins and Liquidating positions](https://youtu.be/u2cUeD72MrQ)
- [Testing our Stablecoin's scripts](https://youtu.be/-MBebK33FOU)
- [Homework](https://youtu.be/yfmLaLcDjtc)

### [Lecture 10](https://www.youtube.com/playlist?list=PLNEK_Ejlx3x0ivViR3g9lAkB4Qj3iejp1)

- [Introduction](https://www.youtube.com/watch?v=Vp4UGDUv8BM&list=PLNEK_Ejlx3x0ivViR3g9lAkB4Qj3iejp1&index=2)
- [Developing a Dapp with MeshJS and PluTs (Typescript)](https://www.youtube.com/watch?v=tazyJWUL0nM&list=PLNEK_Ejlx3x0ivViR3g9lAkB4Qj3iejp1&index=1)
- [Developing smart contracts with PluTs (Typescript)](https://www.youtube.com/watch?v=WN4yxa-ISyk&list=PLNEK_Ejlx3x0ivViR3g9lAkB4Qj3iejp1&index=5)
- [Developing smart contracts with OpShin and PyCardano (Python)](https://www.youtube.com/watch?v=Ale01hnxZEg&list=PLNEK_Ejlx3x0ivViR3g9lAkB4Qj3iejp1&index=3)
- [Developing smart contracts with Plutarch (Haskell)](https://www.youtube.com/watch?v=2PNTJLzcP2k&list=PLNEK_Ejlx3x0ivViR3g9lAkB4Qj3iejp1&index=4)
- [Developing smart contracts with Aiken](https://www.youtube.com/watch?v=Y6x46s60bks&list=PLNEK_Ejlx3x0ivViR3g9lAkB4Qj3iejp1&index=5)
